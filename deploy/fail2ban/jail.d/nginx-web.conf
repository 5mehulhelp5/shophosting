# Fail2Ban web jails for nginx customer sites
# All jails inherit ignoreip from [DEFAULT] in jail.local (includes admin IP)

[nginx-http-auth]
enabled  = true
port     = http,https
filter   = nginx-http-auth
logpath  = /var/log/nginx/customer-*-access.log
           /var/log/nginx/access.log
maxretry = 5
bantime  = 3600
findtime = 600

[nginx-botsearch]
enabled  = true
port     = http,https
filter   = nginx-botsearch
logpath  = /var/log/nginx/customer-*-access.log
           /var/log/nginx/access.log
maxretry = 10
bantime  = 86400
findtime = 600

[nginx-badbots]
enabled  = true
port     = http,https
filter   = nginx-badbots
logpath  = /var/log/nginx/customer-*-access.log
           /var/log/nginx/access.log
maxretry = 2
bantime  = 86400

[wordpress-login]
enabled  = true
port     = http,https
filter   = wordpress-login
logpath  = /var/log/nginx/customer-*-access.log
           /var/log/nginx/access.log
maxretry = 5
bantime  = 3600
findtime = 300

[nginx-limit-req]
enabled  = true
port     = http,https
filter   = nginx-limit-req
logpath  = /var/log/nginx/error.log
maxretry = 5
bantime  = 600
findtime = 300

[modsecurity]
enabled  = true
port     = http,https
filter   = modsecurity
logpath  = /var/log/modsecurity/modsec_audit.log
maxretry = 3
bantime  = 3600
findtime = 600
